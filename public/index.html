<!-- /**
* (C) Copyright IBM Corporation 2016.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/ -->
<!DOCTYPE html>
<html>

<head>
  <title>CodeRally</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/semantic.min.css">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <div class="ui grid container">
    <div class="sixteen wide column">
      <h2 id="page-title" class="ui header" style="text-align: center;">
                NodeJs Code Rally
            </h2>
    </div>
    <div id="auth-seg" class="sixteen wide column">
      <div class="ui segments">
        <div class="ui five top attached steps">
          <div class="active step">
            <i class="lock icon"></i>
            <div class="content">
              <div class="title">Authenticate</div>
              <div class="description">Set up your account</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="car icon"></i>
            <div class="content">
              <div class="title">Pick</div>
              <div class="description">Choose your track and vehicle</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="code icon"></i>
            <div class="content">
              <div class="title">Code</div>
              <div class="description">Modify the parameters</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="check icon"></i>
            <div class="content">
              <div class="title">Confirm</div>
              <div class="description">Confirm your choice</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="checkered flag icon"></i>
            <div class="content">
              <div class="title">Upload &amp; Race</div>
              <div class="description">Use a custom agent code and race!</div>
            </div>
          </div>
        </div>
        <div class="ui very padded segment">
          <div class="ui medium header">Select a Code Rally server: </div>
          <select id="server-dd" class="ui dropdown" onChange="javascript:changeTextBoxState(this)">
            <option value="challenge-na.coderallycloud.com">North American contest server</option>
            <option value="challenge-br.coderallycloud.com">Brazilian contest server</option>
            <option value="challenge-in.coderallycloud.com">Indian contest server</option>
            <option value="challenge-cn.coderallycloud.com">Chinese regional server</option>
            <option value="challenge-eu.coderallycloud.com">European regional server</option>
            <option value="www.coderallycloud.com">Worldwide practise server</option>
            <option value="customServer">Use a custom server</option>
                  </select>
          <div id="custom-server-form">
            <div class="ui medium header">Enter custom server:</div>
            <div class="ui action input">
              <input id="server" type="text" disabled>
              <button id="server-connection" class="ui button" disabled>Check server connection</button>
            </div>
          </div>
          <div id="username-form">
            <div class="ui medium header">Enter your username to get started:</div>
            <div class="ui action input">
              <input id="username" type="text" placeholder="Username...">
              <button id="auth-button" class="ui button">Authenticate</button>
            </div>
          </div>
        </div>
        <div class="ui secondary clearing segment">
          <button id="auth-next-btn" class="ui right labeled icon teal right floated disabled button">
                      <i class="right arrow icon"></i> Next
                  </button>
        </div>
      </div>
    </div>
    <!-- end of auth seg -->

    <!-- begin of select seg -->
    <div id="select-seg" class="sixteen wide column">
      <div class="ui segments">
        <div class="ui five top attached steps">
          <div class="disabled step">
            <i class="lock icon"></i>
            <div class="content">
              <div class="title">Authenticate</div>
              <div class="description">Set up your account</div>
            </div>
          </div>
          <div class="active step">
            <i class="car icon"></i>
            <div class="content">
              <div class="title">Pick</div>
              <div class="description">Choose your track and vehicle</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="code icon"></i>
            <div class="content">
              <div class="title">Code</div>
              <div class="description">Modify vehicle parameters</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="check icon"></i>
            <div class="content">
              <div class="title">Confirm</div>
              <div class="description">Confirm your choice</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="checkered flag icon"></i>
            <div class="content">
              <div class="title">Upload &amp; Race</div>
              <div class="description">Use a custom agent code and race!</div>
            </div>
          </div>
        </div>
        <div class="ui very padded segment">
          <div class="ui medium header">Pick a track: </div>
          <table id="track-table" class="ui table">
            <tbody>
              <tr>
                <td>
                  <img data-track-id="circuit" src="tracks/circuit.jpg" height="80" width="100">
                </td>
                <td>
                  <img data-track-id="desert" src="tracks/desert.jpg" height="80" width="100">
                </td>
                <td>
                  <img data-track-id="desk" src="tracks/desk.jpg" height="80" width="100">
                </td>
                <td>
                  <img data-track-id="figure8" src="tracks/figure8.jpg" height="80" width="100">
                </td>
                <td>
                  <img data-track-id="lowearthorbit" src="tracks/lowearthorbit.jpg" height="80" width="100">
                </td>
                <td>
                  <img data-track-id="pond" src="tracks/pond.jpg" height="80" width="100">
                </td>
                <td>
                  <img data-track-id="sky" src="tracks/sky.jpg" height="80" width="100">
                </td>
                <td>
                  <img data-track-id="space" src="tracks/space.jpg" height="80" width="100">
                </td>
                <td>
                  <img data-track-id="water" src="tracks/water.jpg" height="80" width="100">
                </td>
              </tr>
            </tbody>
          </table>
          <div id="car-select" class="ui medium header" style="display: none">Pick your vehicle: </div>
          <table id="car-table" class="ui table" style="display: none">
            <tbody>
              <tr>
                <td>
                  <img id="img1">
                </td>
                <td>
                  <img id="img2">
                </td>
                <td>
                  <img id="img3">
                </td>
                <td>
                  <img id="img4">
                </td>
                <td>
                  <img id="img5">
                </td>
                <td>
                  <img id="img6">
                </td>
                <td>
                  <img id="img7">
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="ui secondary clearing segment">
          <button id="select-next-btn" class="ui right labeled icon teal right floated disabled button"><i class="right arrow icon"></i> Next</button>
        </div>
      </div>
    </div>
    <!-- end of select seg -->

    <!-- begin of code seg -->
    <div id="code-seg" class="sixteen wide column">
      <div class="ui segments">
        <div class="ui five top attached steps">
          <div class="disabled step">
            <i class="lock icon"></i>
            <div class="content">
              <div class="title">Authenticate</div>
              <div class="description">Set up your account</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="car icon"></i>
            <div class="content">
              <div class="title">Pick</div>
              <div class="description">Choose your track and vehicle</div>
            </div>
          </div>
          <div class="active step">
            <i class="code icon"></i>
            <div class="content">
              <div class="title">Code</div>
              <div class="description">Modify vehicle parameters</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="check icon"></i>
            <div class="content">
              <div class="title">Confirm</div>
              <div class="description">Confirm your choice</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="checkered flag icon"></i>
            <div class="content">
              <div class="title">Upload &amp; Race</div>
              <div class="description">Use a custom agent code and race!</div>
            </div>
          </div>
        </div>
        <div class="ui very padded segment">
          <div class="ui medium header">Modify your vehicle: </div>
          <div id="editor"></div>
          <button id="copy-code-btn" class="ui button">
                        <i class="copy icon"></i>Copy code to clipboard
                    </button>
          <div id="success-copy" style="display:none;color:green">Successfully copied to clipboard</div>
        </div>
        <div class="ui secondary clearing segment">
          <button id="code-next-btn" class="ui right labeled icon teal right floated button"><i class="right arrow icon"></i> Next</button>
          <button id="code-prev-btn" class="ui left labeled icon teal left floated button"><i class="left arrow icon"></i> Previous</button>
        </div>
      </div>
    </div>
    <!-- end of code seg -->

    <!-- begin of race seg -->
    <div id="race-seg" class="sixteen wide column">
      <div class="ui segments">
        <div class="ui five top attached steps">
          <div class="disabled step">
            <i class="lock icon"></i>
            <div class="content">
              <div class="title">Authenticate</div>
              <div class="description">Set up your account</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="car icon"></i>
            <div class="content">
              <div class="title">Pick</div>
              <div class="description">Choose your track and vehicle</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="code icon"></i>
            <div class="content">
              <div class="title">Code</div>
              <div class="description">Modify vehicle parameters</div>
            </div>
          </div>
          <div class="active step">
            <i class="check icon"></i>
            <div class="content">
              <div class="title">Confirm</div>
              <div class="description">Confirm your choice</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="checkered flag icon"></i>
            <div class="content">
              <div class="title">Upload &amp; Race</div>
              <div class="description">Use a custom agent code and race!</div>
            </div>
          </div>
        </div>
        <div class="ui very padded segment">
          <div class="ui medium header">Confirm your choices:</div>
          <div class="ui grid">
            <div class="six wide column">
              <h3 class="ui header">
                                  <i class="user circular icon"></i>
                                  <div id="user-summary" class="content"></div>
                              </h3>
              <h3 class="ui header">
                              <img id="track-img" src="" class="ui circular image">
                                  Your track
                              </h3>
              <h3 class="ui header">
                              <img id="ride-img" src="" class="ui circular image">
                                  Your ride
                              </h3>
            </div>
            <div class="ten wide column">
              <div id="editor_result"></div>
            </div>
          </div>
        </div>
        <div class="ui secondary clearing segment">
          <button id="race-next-btn" class="ui right labeled icon teal right floated button"><i class="right arrow icon"></i> Next</button>
          <button id="race-prev-btn" class="ui left labeled icon teal left floated button"><i class="left arrow icon"></i> Previous</button>
        </div>
      </div>
    </div>
    <!-- end of race seg -->

    <!-- begin of upload seg -->
    <div id="upload-seg" class="sixteen wide column">
      <div class="ui segments">
        <div class="ui five top attached steps">
          <div class="disabled step">
            <i class="lock icon"></i>
            <div class="content">
              <div class="title">Authenticate</div>
              <div class="description">Set up your account</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="car icon"></i>
            <div class="content">
              <div class="title">Pick</div>
              <div class="description">Choose your track and vehicle</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="code icon"></i>
            <div class="content">
              <div class="title">Code</div>
              <div class="description">Modify the parameters</div>
            </div>
          </div>
          <div class="disabled step">
            <i class="check icon"></i>
            <div class="content">
              <div class="title">Confirm</div>
              <div class="description">Confirm your choice</div>
            </div>
          </div>
          <div class="active step">
            <i class="checkered flag icon"></i>
            <div class="content">
              <div class="title">Upload &amp; Race</div>
              <div class="description">Use a custom agent code and race!</div>
            </div>
          </div>
        </div>
        <div class="ui very padded segment">
          <div id="agent-form">
            <div class="panel panel-default">
              <div class="panel-body">
                <div class="ui medium header">Download the default agent code:
                  <a href="js/customAgent.js" download>Download now!</a>
                </div>
                <div class="ui medium header">Want to use a customized agent code? Upload it here:</div>
                <input id="upload-input" type="file" name="uploads[]" accept=".js">
                <div class="progress">
                  <div class="progress-bar" role="progressbar"></div>
                </div>
                <button class="btn btn-lg upload-btn" type="button">Upload File</button>
                <div id="instructions-upload">
                  <p><b>*Instructions to upload file:</b> Please make sure the file is named <b><i>customAgent.js</i></b> and follows the same format as the default agent code.</p>
                </div>
                <div id="notes-upload" style="display: none;">
                  <p style="color:red;"><b>WARNING: An existing customized agent code has been found. By default the race will use the custom code.</b>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="ui secondary clearing segment">
          <button id="upload-next-btn" class="ui right labeled icon blue right floated button"><i class="checkered flag icon"></i> Begin race</button>
          <button id="upload-prev-btn" class="ui left labeled icon teal left floated button"><i class="left arrow icon"></i> Previous</button>
        </div>
      </div>
    </div>
    <!-- end of upload seg -->

    <!-- begin of log seg -->
    <div id="log-seg" class="sixteen wide column">
      <div class="ui very padded center aligned segment">
        <div class="ui top left attached label">Real time race stats</div>
        <div class="ui statistics">
          <div class="statistic">
            <div class="value">
              <i class="road icon"></i> <span id="lap"></span>
            </div>
            <div class="label">
              Current Lap
            </div>
          </div>
        </div>
        <div class="ui segments">
          <div class="ui padded segment">
            <div class="ui medium header">Real Time Race Logs</div>
            <div id="race-start-btn" style="display: none;">
              <button id="start-race" class="ui right labeled icon blue center floated button disabled">
                                <i class="checkered flag icon"></i> Watch the race live
                            </button>
            </div>
            <h2 id="race-wait">Waiting for race to begin ... </h2>
          </div>
          <div class="ui very padded segment">
            <div class="ui list"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- end of log seg -->

  <div class="ui inverted vertical footer very padded segment">
    <div class="ui center aligned container">
      <div class="ui stackable inverted divided grid">
        <div class="eight wide column">
          <h4 class="ui inverted header">Get the Code!</h4>
          <div class="ui inverted link list">
            <a href="#" class="item"><i class="github icon"></i> GitHub</a>
          </div>
        </div>
        <div class="eight wide column">
          <h4 class="ui inverted header">Official Code Rally Docs</h4>
          <a href="https://www.ibm.com/developerworks/community/blogs/code-rally/entry/landing?lang=en">IBM Code Rally</a>
        </div>
      </div>
    </div>
  </div>
  <script>
    function changeTextBoxState(server) {
      if (server.value == 'customServer') {
        $("#username").val("");
        $('#username').attr("disabled", true);

        $("#auth-button").removeClass("positive");
        $("#auth-button").removeClass("negative");
        $("#auth-button").text("Authenticate");
        $("#auth-button").addClass('disabled');

        $("#auth-next-btn").addClass("disabled");

        $("#server").attr("disabled", false);
        $("#server-connection").attr("disabled", false);
      } else {
        $("#username").val("");
        $('#username').attr("disabled", false);

        $("#auth-button").removeClass("positive");
        $("#auth-button").removeClass("negative");
        $("#auth-button").text("Authenticate");
        $("#auth-button").removeClass('disabled');

        $("#auth-next-btn").addClass("disabled");

        $("#server").val("");
        $("#server").attr("disabled", true);

        $("#server-connection").attr("disabled", true);
        $("#server-connection").removeClass('positive');
        $("#server-connection").text('Check server connection');
      }
    }
  </script>
  <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
  <script src="js/semantic.min.js"></script>
  <script src="/scripts/ace.js" type="text/javascript" charset="utf-8"></script>
  <script>
    var editor_js = ace.edit("editor");

    editor_js.setTheme("ace/theme/monokai");
    editor_js.getSession().setMode("ace/mode/json");
    editor_js.getSession().setOption("useWorker", false);

    var editor_result = ace.edit("editor_result");

    editor_result.setTheme("ace/theme/monokai");
    editor_result.getSession().setMode("ace/mode/json");
    editor_result.getSession().setOption("useWorker", false);
    editor_result.setReadOnly(true);
  </script>
  <script>
    $('.ui.dropdown').dropdown();

    $.ajax({
      url: '/js/uploads/customAgent.js',
      type: 'HEAD',
      error: function() {
        // do nothing
      },
      success: function() {
        $('#notes-upload').css('display', 'block');
      }
    });

    $('#auth-next-btn').on('click', function() {
      $('#auth-seg').fadeOut('fast', function() {
        $('#select-seg').fadeIn('slow');
      });
    });

    $('#select-next-btn').on('click', function() {
      $('#select-seg').fadeOut('fast', function() {
        $('#code-seg').fadeIn('slow');
      });
    });

    $('#code-prev-btn').on('click', function() {
      $('#code-seg').fadeOut('fast', function() {
        $('#select-seg').fadeIn('slow');
      });
    });
    $('#code-next-btn').on('click', function() {
      $('#code-seg').fadeOut('fast', function() {
        $('#race-seg').fadeIn('slow');
      });
    });

    $('#race-prev-btn').on('click', function() {
      $('#race-seg').fadeOut('fast', function() {
        $('#code-seg').fadeIn('slow');
      });
    });
    $('#race-next-btn').on('click', function() {
      $('#race-seg').fadeOut('fast', function() {
        $('#upload-seg').fadeIn('slow');
      });
    });

    $('#upload-prev-btn').on('click', function() {
      $('#upload-seg').fadeOut('fast', function() {
        $('#race-seg').fadeIn('slow');
      });
    });
    $('#upload-next-btn').on('click', function() {
      $('#upload-seg').fadeOut('fast', function() {
        $('#log-seg').fadeIn('slow');
      });
    });
  </script>
  <script src="js/auth.js"></script>
  <script src="js/select.js" defer></script>
  <script src="js/code.js" defer></script>
  <script src="js/race.js" defer></script>
  <script src="js/upload.js"></script>
  <script src="/socket.io/socket.io.js"></script>
</body>

</html>
